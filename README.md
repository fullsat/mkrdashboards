## Why

MackerelのダッシュボードをぽちぽちGUIで作っていられないのでYamlでパラメータ指定したらダッシュボードを生成してくれるようにする

---

自分のユースケースにおいて、リソースの可視化ツールはだいたい以下のために利用しています。

* 問題の原因特定
* キャパシティプランニング

問題の原因特定に関して、自分の行動パターンを振り返ってみると、リソース可視化ツールの使い方は以下のように使っていることが多いです。

* ユーザ体験が悪化していた期間の特定
* その期間において各ホストのグラフにおかしなパターンがないか確認
* おかしなパターンがあれば原因の仮設を立てる

あとは仮設が正しいかどうかを繰り返し、間違っていれば再度仮設を立てる、ということになります。

キャパシティプランニングの観点では、以下のように使っています

* 長期的なリソースのグラフを確認
* メモリリークや意図していない部分のディスクが膨れているなどを確認

クラウドの時代になってからキャパシティを考えると言うよりは不具合がないかを見るために長期的なリソースを確認しています。
※定期的にインスタンスを入れ替えるようにしてたらおそらくこれらの観点は不要

これらの使い方の中で、グラフの期間指定のパターンとしては以下のパターンがあることに気づきました

* 短/中/長期的に問題の発生している期間を特定する
* 特定した期間だけを切り取ったグラフを確認する
* 切り取ったグラフは短/中/長期的に見てもおかしな値を示している
* 問題の原因または原因によって引き起こされた異常値として考えられる

このようなパターンにとって便利なようなダッシュボードを作成したいですが、
GUIで大量のグラフを生成するのは現実的ではありませんでした。

変更するときにも不便です。

そのためこのツールを作成しました。

## What

ツールで作成されるダッシュボードは以下のとおりです

* Mackerelのカスタムダッシュボードを作成する
* 時間軸が可変、6時間、3日間、1ヶ月の4列のダッシュボード(デフォルト)
* 必要があれば時間軸は変更が可能
* 表示させるグラフは自分で指定できる
* ホストにしかメトリクスが存在しない場合はロールに属するホストを1行1行表示していく

## How

```
git clone https://github.com/fullsat/mkrdashboards
cd mkrdashboards
bundle install
export MACKEREL_APIKEY="xxxxxxxxxxxxx"
vim conf.d/config.yml
bundle exec exe/mkrdashboards create --with-delete --config conf.d/config.yml -k "xxxxxxxxxxxxx"
```
